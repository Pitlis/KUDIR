SELECT     dbo.Работник.работникID, dbo.Работник.ФИО, dbo.Страховой_взнос.Дата, dbo.Get_ОбщаяСуммаВыплат(dbo.Работник.работникID, 
                      dbo.Страховой_взнос.Дата) AS [Общая сумма выплат], dbo.Get_СуммаВыплатНачисляютсяСтрахВзносы(dbo.Работник.работникID, 
                      dbo.Страховой_взнос.Дата) AS [Сумма на которую начисл страх взносы], 
                      CAST(dbo.Get_СуммаВыплатНачисляютсяСтрахВзносы(dbo.Работник.работникID, dbo.Страховой_взнос.Дата) 
                      * (CAST(dbo.Работник.Тариф_страх_взносов AS REAL) / 100) AS MONEY) AS [Сумма начисл страх взносов всего], 
                      dbo.Get_СуммаВыплатНачисляютсяСтрахВзносы(dbo.Работник.работникID, dbo.Страховой_взнос.Дата) / 100 AS [в том числе 1 процент], 
                      dbo.Страховой_взнос.Иные_платежи AS [Иные платежи], 
                      dbo.Страховой_взнос.Перечислено_Фондом_плательщику AS [Перечислено фондом плательщику], 
                      dbo.Get_СуммаНачислПособий(dbo.Работник.работникID, dbo.Страховой_взнос.Дата) AS [Сумма начисленных пособий], 
                      dbo.Страховой_взнос.Задолж_за_пред_период AS [Остаток задолженности за пред период], 
                      CAST(dbo.Get_СуммаВыплатНачисляютсяСтрахВзносы(dbo.Работник.работникID, dbo.Страховой_взнос.Дата) 
                      * (CAST(dbo.Работник.Тариф_страх_взносов AS REAL) / 100) + ISNULL(dbo.Страховой_взнос.Иные_платежи, 0) 
                      + ISNULL(dbo.Страховой_взнос.Перечислено_Фондом_плательщику, 0) - dbo.Get_СуммаНачислПособий(dbo.Работник.работникID, 
                      dbo.Страховой_взнос.Дата) + ISNULL(dbo.Страховой_взнос.Задолж_за_пред_период, 0) AS MONEY) AS [Подлежит уплате], 
                      dbo.view_Платежный_док.Сумма AS [Перечислено в Фонд], dbo.view_Платежный_док.Дата AS [Дата плат инстр], 
                      dbo.view_Платежный_док.Номер_платежного_документа AS [Номер плат инстр], 
                      dbo.Get_СуммаВыплатНачисляютсяСтрахВзносы(dbo.Работник.работникID, dbo.Страховой_взнос.Дата) 
                      * (CAST(dbo.Работник.Тариф_страх_взносов AS REAL) / 100) + ISNULL(dbo.Страховой_взнос.Иные_платежи, 0) 
                      + ISNULL(dbo.Страховой_взнос.Перечислено_Фондом_плательщику, 0) - dbo.Get_СуммаНачислПособий(dbo.Работник.работникID, 
                      dbo.Страховой_взнос.Дата) + ISNULL(dbo.Страховой_взнос.Задолж_за_пред_период, 0) - ISNULL(dbo.view_Платежный_док.Сумма, 0) 
                      AS [Остаток задолженности], dbo.view_Платежный_док.ID_платежный_док, dbo.Страховой_взнос.DEL, 
                      dbo.Страховой_взнос.За_месяц AS [За месяц], dbo.Страховой_взнос.Рабочих_дней AS [Количество рабочих дней]
FROM         dbo.Работник INNER JOIN
                      dbo.Страховой_взнос ON dbo.Работник.работникID = dbo.Страховой_взнос.работникID LEFT OUTER JOIN
                      dbo.view_Платежный_док ON dbo.Страховой_взнос.ID_платежный_док = dbo.view_Платежный_док.ID_платежный_док
WHERE     (dbo.Страховой_взнос.DEL = 0)