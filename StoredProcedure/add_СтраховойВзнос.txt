CREATE PROCEDURE add_СтраховойВзнос
@работникID INT,
@Дата DATETIME,
@Дней SMALLINT,
@ИныеПлатежи MONEY,
@ПеречисленоФондом MONEY,
@ЗадолжЗаПредПериод MONEY,
@ЗаМесяц TINYINT,
@Номер_ПлатежныйДок VARCHAR(20),
@Дата_ПлатежныйДок DATETIME,
@Сумма_ПлатежныйДок MONEY
AS

DECLARE @IDdoc INT
IF (@Номер_ПлатежныйДок IS NOT NULL)
	BEGIN
		EXEC add_ПлатежныйДокумент @Номер_ПлатежныйДок, @Дата_ПлатежныйДок, @Сумма_ПлатежныйДок, @IDdoc output;
	END
	
IF (@ЗаМесяц IS NULL)
	BEGIN SET @ЗаМесяц = MONTH(@Дата) END

INSERT INTO Страховой_взнос (работникID, Дата, Рабочих_дней, Иные_платежи, Перечислено_Фондом_плательщику, Задолж_за_пред_период, За_месяц, ID_платежный_док, DEL)
VALUES (@работникID, @Дата, @Дней, @ИныеПлатежи, @ПеречисленоФондом, @ЗадолжЗаПредПериод, @ЗаМесяц, @IDdoc, 0)