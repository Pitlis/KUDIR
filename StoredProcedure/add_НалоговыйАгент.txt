CREATE PROCEDURE add_НалоговыйАгент
@Наимен_организации VARCHAR(100),
@Страна VARCHAR(100),
@Вид_дохода VARCHAR(150),
@Дата_платежа DATETIME,
@Сумма_платежа MONEY,
@Сумма_затрат_для_налога MONEY,
@Сумма_освоб_от_налога_РБ MONEY,
@Сумма_освоб_от_налога_международн MONEY,
@Ставка_налога_РБ SMALLINT,
@Ставка_налога_международн INT,
@Номер_ПлатежныйДок VARCHAR(20),
@Дата_ПлатежныйДок DATETIME,
@Сумма_ПлатежныйДок MONEY
AS
DECLARE @IDdoc INT
IF (@Номер_ПлатежныйДок IS NOT NULL)
	BEGIN
		EXEC add_ПлатежныйДокумент @Номер_ПлатежныйДок, @Дата_ПлатежныйДок, @Сумма_ПлатежныйДок, @IDdoc output;
	END

INSERT INTO Налоговый_агент (Наимен_организации, Страна, Вид_дохода, Дата_платежа, Сумма_платежа, Сумма_затрат_для_налога, Сумма_освоб_от_налога_РБ, Сумма_освоб_от_налога_международн, Ставка_налога_РБ, Ставка_налога_международн, ID_платежный_док, DEL)
VALUES (@Наимен_организации, @Страна, @Вид_дохода, @Дата_платежа, @Сумма_платежа, @Сумма_затрат_для_налога, @Сумма_освоб_от_налога_РБ, @Сумма_освоб_от_налога_международн, @Ставка_налога_РБ, @Ставка_налога_международн, @IDdoc, 0)